
 <!DOCTYPE HTML>
<html >
<head>
  <meta charset="UTF-8">
  
    <title>How to use Sinon.js and ExtPromise to test Ajax in ExtJS | Thinking in Crowd / 鹄思乱想</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=3, minimum-scale=1">
    
    <meta name="author" content="鹄思乱想">
    
    <meta name="description" content="Ajax Usage Sample in ExtJSImagine we have a simple scenario that we have to validate user login ID when onblur event occurs in a user registration pag">
    
    
    
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="kenspirit" />
    <meta name="twitter:title" content="How to use Sinon.js and ExtPromise to test Ajax in ExtJS | Thinking in Crowd / 鹄思乱想" />
      
    
    
    <link rel="alternate" href="/atom.xml" title="Thinking in Crowd / 鹄思乱想" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/qmark.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/qmark.jpg">
    
    <link rel="stylesheet" href="/css/style.css">
</head>

  <body>
    <header>
      <div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="Thinking in Crowd / 鹄思乱想" title="Thinking in Crowd / 鹄思乱想"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="Thinking in Crowd / 鹄思乱想">Thinking in Crowd / 鹄思乱想</a></h1>
				<h2 class="blog-motto">Swan flying in the immense sky</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					
						<li><a href="/">Home</a></li>
					
						<li><a href="/about">About</a></li>
					
						<li><a href="/algorithm">Algorithm</a></li>
					
						<li><a href="/kanban">Kanban</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
					<li>
					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="text" id="search" name="q" autocomplete="off" maxlength="20" placeholder="搜索" />
						<input type="hidden" name="q" value="site:www.thinkingincrowd.me">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>

    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2016/05/16/How-to-use-Sinon-js-to-test-Ajax-in-ExtJS/" title="How to use Sinon.js and ExtPromise to test Ajax in ExtJS" itemprop="url">How to use Sinon.js and ExtPromise to test Ajax in ExtJS</a>
  </h1>
  <p class="article-author">By
    
      <a href="https://plus.google.com/108764880042816550000?rel=author" title="鹄思乱想" target="_blank" itemprop="author">鹄思乱想</a>
    </p>
  <p class="article-time">
    <time datetime="2016-05-16T14:09:01.000Z" itemprop="datePublished">May 16 2016</time>
    更新日期:<time datetime="2016-06-05T07:16:30.000Z" itemprop="dateModified">Jun 5 2016</time>
    
  </p>
</header>
	<div class="article-content">
		
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">文章目录</strong>
		<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Ajax-Usage-Sample-in-ExtJS"><span class="toc-number">1.</span> <span class="toc-text">Ajax Usage Sample in ExtJS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Sinon-js"><span class="toc-number">2.</span> <span class="toc-text">Sinon.js</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ExtPromise"><span class="toc-number">3.</span> <span class="toc-text">ExtPromise</span></a></li></ol>
		</div>
		
		<h2 id="Ajax-Usage-Sample-in-ExtJS"><a href="#Ajax-Usage-Sample-in-ExtJS" class="headerlink" title="Ajax Usage Sample in ExtJS"></a>Ajax Usage Sample in ExtJS</h2><p>Imagine we have a simple scenario that we have to validate user login ID when <code>onblur</code> event occurs in a user registration page.  The <code>validateLoginID</code> method below is a simple implementation of the event listener.  </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">validateLoginID: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> loginIDCmp = Ext.getCmp(<span class="string">'loginID'</span>)，</div><div class="line">        loginID = loginIDCmp.getValue();</div><div class="line"></div><div class="line">    Ext.Ajax.request(&#123;</div><div class="line">        url : <span class="string">'/loginId/validate'</span>,</div><div class="line">        method : <span class="string">'GET'</span>,</div><div class="line">        params : &#123;</div><div class="line">            loginID : loginID</div><div class="line">        &#125;,</div><div class="line">        success : <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</div><div class="line">            <span class="keyword">if</span> (data.responseText != <span class="string">''</span>) &#123;</div><div class="line">                loginIDCmp.markInvalid(<span class="string">'Login ID is taken already.'</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;,</div><div class="line">        failure : <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</div><div class="line">            alert(<span class="string">'Server Error.'</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>If we would like to test this piece of code, how should we do that?  This event listener encapsulates the <code>Ext.Ajax.request</code> completely with two anonymous functions as the <code>success</code> and <code>failure</code> callbacks.  </p>
<p>Is that we must change the anonymous callbacks into named functions to test individually?  In real ExtJS application code, many callbacks are short and not-reusable.  They acts as private functions that belongs to implementation detail and we seldom split them out to test individually.  <strong>When we write testing script, we test against the interface, the contracted behavior provided.  It’s just that this contract is not a simple return value but UI behaviors.</strong>  I think this is also why UI testing is more unfamiliar and difficult to test for most of the developers.</p>
<p><strong>Does that mean we can only use Selenium or Robot Framework to simulate user operation in browser and test?  Not Really.  We can manually fire event on ExtJS Component, fake XMLHttpRequest and response by Unit Test.</strong>  This would be more flexible and lightweighted.</p>
<h2 id="Sinon-js"><a href="#Sinon-js" class="headerlink" title="Sinon.js"></a>Sinon.js</h2><p><a href="http://sinonjs.org/" target="_blank" rel="external">Sinon.js</a> can be used to fake XMLHttpRequest and response.  Below test spec tests from two angles:  </p>
<ol>
<li><code>onblur</code> event can trigger the validation for LoginID  </li>
<li>Based on the mock Ajax response，Login ID component can display desired error message.  </li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">describe(<span class="string">'Login ID Unique Validation - Duplicate'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> xhr, ajax;</div><div class="line"></div><div class="line">    before(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        xhr = sinon.useFakeXMLHttpRequest();</div><div class="line">        xhr.onCreate = <span class="function"><span class="keyword">function</span>(<span class="params">xhr</span>) </span>&#123;</div><div class="line">            ajax = xhr;</div><div class="line">        &#125;;</div><div class="line">    &#125;);</div><div class="line"></div><div class="line">    after(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        xhr.restore();</div><div class="line">    &#125;);</div><div class="line"></div><div class="line">    it(<span class="string">'Focus leaving name field should trigger unique validation.'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">done</span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> loginCmp = <span class="keyword">new</span> com.foo.loginComponent(&#123;&#125;),</div><div class="line">            loginIDCmp = Ext.getCmp(<span class="string">'loginID'</span>);</div><div class="line"></div><div class="line">        loginIDCmp.setValue(<span class="string">'Ken'</span>);</div><div class="line">        loginIDCmp.fireEvent(<span class="string">'blur'</span>);</div><div class="line"></div><div class="line">        ajax.respond(<span class="number">200</span>,</div><div class="line">            &#123; <span class="string">'Content-Type'</span>: <span class="string">'application/json'</span> &#125;,</div><div class="line">            <span class="string">'Login ID is taken already.'</span>);</div><div class="line"></div><div class="line">        setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">           expect(loginIDCmp.getActiveError())</div><div class="line">               .to.equal(<span class="string">'Login ID is taken already.'</span>);</div><div class="line">           done();</div><div class="line">        &#125;, <span class="number">100</span>);</div><div class="line">    &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>Not sure if you have spotted any special handling in above test spec.  At the very end, we must use <code>setTimeout</code> and <code>done</code> to write it in async style.  Why?  </p>
<p>Actually, the Ajax implementation in ExtJS use <code>setInterval</code> to keep polling the <code>readystate</code> of the XMLHttpRequest.  When it detects that the ready state is changed and indicated that the Ajax call is completed, it calls the callback correspondingly.</p>
<p>Hence, if we don’t use our <code>setTimeout</code> to postpone the <code>expect</code> assertion, it runs immediately without a chance to wait the execution of the callbacks.  This test spec will never pass.</p>
<p>However, this kind of hack is quite ugly if you agree.  And how can I know how much time it needs before Ajax request starts?  How can I know whether the timer to check Ajax ready state in ExtJS will be changed in the future?  If we don’t want to write our test code like this, how can we test any ExtJS application code involves Ajax request?  </p>
<h2 id="ExtPromise"><a href="#ExtPromise" class="headerlink" title="ExtPromise"></a>ExtPromise</h2><p>What we want is that our assertion will be executed only when Ajax request completes.  Hence, it would be a charm if <code>Ext.Ajax.request</code> returns a Promise in ExtJS 3/4.  Before, I wrote the <a href="https://github.com/kenspirit/ExtPromise" target="_blank" rel="external">ExtPromise</a> when I first learned Promise and intended to use it to replace some flag cross-checking logic in my team.  Now, I can have one more reason to persuade them to use it instead of plain <code>Ext.Ajax.request</code>.  As you can see below, it takes little effort to change original application code.  </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Source</span></div><div class="line">validateLoginID: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> loginIDCmp = Ext.getCmp(<span class="string">'loginID'</span>)，</div><div class="line">        loginID = loginIDCmp.getValue();</div><div class="line"></div><div class="line">    <span class="keyword">return</span> ExtPromise.Ajax().request(&#123;</div><div class="line">            url : <span class="string">'/loginId/validate'</span>,</div><div class="line">            method : <span class="string">'GET'</span>,</div><div class="line">            params : &#123;</div><div class="line">                loginID : loginID</div><div class="line">            &#125;</div><div class="line">        &#125;)</div><div class="line">        .then(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</div><div class="line">            <span class="keyword">var</span> errMsg = <span class="string">''</span>;</div><div class="line">            <span class="keyword">if</span> (data.responseText != <span class="string">''</span>) &#123;</div><div class="line">                errMsg = <span class="string">'Login ID is taken already.'</span>；</div><div class="line">                loginIDCmp.markInvalid(errMsg);</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">return</span> errMsg;</div><div class="line">        &#125;,</div><div class="line">        <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            <span class="keyword">return</span> <span class="string">'Server Error.'</span>;</div><div class="line">        &#125;)</div><div class="line">        .then(<span class="function"><span class="keyword">function</span>(<span class="params">errMsg</span>) </span>&#123;</div><div class="line">            <span class="keyword">return</span> errMsg;</div><div class="line">        &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Since the application code is changed to be in Promise style, we can consider how to change our test spec.  It’s said that this test contains two parts, one is the Ajax logic and the other one is the <code>onblur</code> event triggering.</p>
<p>If now we have to change to use direct function calls to take advantage of the Promise style for testing, how can we test the event triggering then?  Actually, we can still manually trigger the event, and use <code>sinon.stub</code> to detect how many times <code>validateLoginID</code> are called.  One thing to be careful is that, when registering the event listener, we cannot directly bind the <code>validateLoginID</code> to the event, and must encloses it in another function.  </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">loginIDCmp.on(<span class="string">'blur'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;loginCmp.validateName();&#125;, loginCmp);</div></pre></td></tr></table></figure>
<p>Below I will mainly focus on explaining the Ajax testing part.  This time we have to use the <code>fakeServer</code> in Sinon and most importantly to configure the server to respond immediately so that we don’t have to manually write <code>server.respond</code>.  Actually, you cannot even find a suitable place to write that even if you want.  As you can see now, the code for test assertion follows naturally after changing the application code to Promise style.  </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Spec</span></div><div class="line">describe(<span class="string">'Login ID Unique Validation - Duplicate'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> server;</div><div class="line"></div><div class="line">    before(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        server = sinon.fakeServer.create(); </div><div class="line">        server.configure(&#123;respondImmediately: <span class="literal">true</span>&#125;);</div><div class="line">    &#125;);</div><div class="line"></div><div class="line">    after(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        server.restore();</div><div class="line">    &#125;);</div><div class="line"></div><div class="line">    it(<span class="string">'Focus leaving name field should trigger unique validation.'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">done</span>) </span>&#123;</div><div class="line">        server.respondWith(<span class="string">'GET'</span>, <span class="string">'/foo'</span>,</div><div class="line">            [<span class="number">200</span>, &#123; <span class="string">'Content-Type'</span>: <span class="string">'application/json'</span> &#125;,</div><div class="line">             <span class="string">'Login ID is taken already.'</span>]);</div><div class="line"></div><div class="line">        <span class="keyword">var</span> loginCmp = <span class="keyword">new</span> com.foo.loginComponent(&#123;&#125;),</div><div class="line">            loginIDCmp = Ext.getCmp(<span class="string">'loginID'</span>);</div><div class="line"></div><div class="line">        loginIDCmp.setValue(<span class="string">'Ken'</span>);</div><div class="line"></div><div class="line">        <span class="comment">// If still want to test event trigger</span></div><div class="line">        <span class="comment">// </span></div><div class="line">        <span class="comment">// var stubbed = sinon.stub(loginCmp, 'validateLoginID');</span></div><div class="line">        <span class="comment">// loginIDCmp.fireEvent('blur');</span></div><div class="line">        <span class="comment">// expect(stubbed.calledOnce).to.be.true;</span></div><div class="line">        <span class="comment">// stubbed.restore();</span></div><div class="line"></div><div class="line">        loginCmp.validateLoginID()</div><div class="line">            .then(<span class="function"><span class="keyword">function</span>(<span class="params">errMsg</span>) </span>&#123;</div><div class="line">                expect(loginIDCmp.getActiveError()).to.equal(</div><div class="line">                  <span class="string">'Login ID is taken already.'</span>);</div><div class="line">             &#125;)</div><div class="line">            .then(done)</div><div class="line">            .catch(done);</div><div class="line">    &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>Please feel free to leave your comment or suggestion on how to test UI behavior and what should be tested.  </p>
  
	</div>
		<footer class="article-footer clearfix">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Sword/">Sword</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Javascript/">Javascript</a><a href="/tags/Promise/">Promise</a><a href="/tags/Sinon-js/">Sinon.js</a><a href="/tags/ExtJS/">ExtJS</a><a href="/tags/Unit-Test/">Unit Test</a>
  </div>


<div class="article-share" id="share">

  <div data-url="http://www.thinkingincrowd.me/2016/05/16/How-to-use-Sinon-js-to-test-Ajax-in-ExtJS/" data-title="How to use Sinon.js and ExtPromise to test Ajax in ExtJS | Thinking in Crowd / 鹄思乱想" data-tsina="kenspirit" class="share clearfix">
  </div>

</div>
</footer>   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2016/06/05/How-to-make-long-running-loop-breakable/" title="How to make long running loop breakable?">
  <strong>PREVIOUS:</strong><br/>
  <span>
  How to make long running loop breakable?</span>
</a>
</div>


<div class="next">
<a href="/2016/04/21/How-to-Read-a-Book/"  title="什么样的读书姿势才正确">
 <strong>NEXT:</strong><br/> 
 <span>什么样的读书姿势才正确
</span>
</a>
</div>

</nav>

	<section class="comment">
	
  
    <div id="disqus_thread"></div>
  
</section>

</div>  
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目录</strong>
  <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Ajax-Usage-Sample-in-ExtJS"><span class="toc-number">1.</span> <span class="toc-text">Ajax Usage Sample in ExtJS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Sinon-js"><span class="toc-number">2.</span> <span class="toc-text">Sinon.js</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ExtPromise"><span class="toc-number">3.</span> <span class="toc-text">ExtPromise</span></a></li></ol>
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
			<li><a href="/categories/Life/" title="Life">Life<sup>6</sup></a></li>
		
			<li><a href="/categories/Sword/" title="Sword">Sword<sup>28</sup></a></li>
		
			<li><a href="/categories/Think/" title="Think">Think<sup>51</sup></a></li>
		
		</ul>
</div>


  
  <div class="tagcloudlist">
    <p class="asidetitle">标签云</p>
    <div class="tagcloudlist clearfix">
       <a href="/tags/AMD/" style="font-size: 10px;">AMD</a> <a href="/tags/Adapt/" style="font-size: 10px;">Adapt</a> <a href="/tags/Adoption/" style="font-size: 10px;">Adoption</a> <a href="/tags/Ajax/" style="font-size: 11.25px;">Ajax</a> <a href="/tags/Analytical-Reading/" style="font-size: 10px;">Analytical Reading</a> <a href="/tags/AngularJS/" style="font-size: 16.25px;">AngularJS</a> <a href="/tags/Async/" style="font-size: 10px;">Async</a> <a href="/tags/Attention/" style="font-size: 10px;">Attention</a> <a href="/tags/Babel/" style="font-size: 10px;">Babel</a> <a href="/tags/Believe/" style="font-size: 10px;">Believe</a> <a href="/tags/Blogging/" style="font-size: 10px;">Blogging</a> <a href="/tags/Book/" style="font-size: 15px;">Book</a> <a href="/tags/CSS/" style="font-size: 10px;">CSS</a> <a href="/tags/Calisthenics/" style="font-size: 10px;">Calisthenics</a> <a href="/tags/Callback/" style="font-size: 10px;">Callback</a> <a href="/tags/Change/" style="font-size: 13.75px;">Change</a> <a href="/tags/Coding/" style="font-size: 12.5px;">Coding</a> <a href="/tags/Connect/" style="font-size: 10px;">Connect</a> <a href="/tags/Constructor/" style="font-size: 10px;">Constructor</a> <a href="/tags/Critical-Thinking/" style="font-size: 10px;">Critical Thinking</a> <a href="/tags/DB/" style="font-size: 10px;">DB</a> <a href="/tags/Delegation/" style="font-size: 11.25px;">Delegation</a> <a href="/tags/Design/" style="font-size: 11.25px;">Design</a> <a href="/tags/Destiny/" style="font-size: 11.25px;">Destiny</a> <a href="/tags/Directive/" style="font-size: 11.25px;">Directive</a> <a href="/tags/ES6/" style="font-size: 10px;">ES6</a> <a href="/tags/Excel/" style="font-size: 10px;">Excel</a> <a href="/tags/Execution-context/" style="font-size: 10px;">Execution context</a> <a href="/tags/Experience/" style="font-size: 11.25px;">Experience</a> <a href="/tags/ExtJS/" style="font-size: 10px;">ExtJS</a> <a href="/tags/ExtJs/" style="font-size: 17.5px;">ExtJs</a> <a href="/tags/Flow/" style="font-size: 11.25px;">Flow</a> <a href="/tags/Function-definition/" style="font-size: 10px;">Function definition</a> <a href="/tags/Functional-Programming/" style="font-size: 15px;">Functional Programming</a> <a href="/tags/GTD/" style="font-size: 11.25px;">GTD</a> <a href="/tags/Goal/" style="font-size: 15px;">Goal</a> <a href="/tags/Habit/" style="font-size: 10px;">Habit</a> <a href="/tags/HangJS/" style="font-size: 10px;">HangJS</a> <a href="/tags/Health/" style="font-size: 10px;">Health</a> <a href="/tags/HttpBackend/" style="font-size: 11.25px;">HttpBackend</a> <a href="/tags/Influence/" style="font-size: 10px;">Influence</a> <a href="/tags/Inheritance/" style="font-size: 10px;">Inheritance</a> <a href="/tags/JAWR/" style="font-size: 10px;">JAWR</a> <a href="/tags/JSConf/" style="font-size: 11.25px;">JSConf</a> <a href="/tags/JSON/" style="font-size: 11.25px;">JSON</a> <a href="/tags/Jasmine/" style="font-size: 17.5px;">Jasmine</a> <a href="/tags/Javascript/" style="font-size: 20px;">Javascript</a> <a href="/tags/JingJS/" style="font-size: 10px;">JingJS</a> <a href="/tags/Kanban/" style="font-size: 16.25px;">Kanban</a> <a href="/tags/Lead-Time/" style="font-size: 10px;">Lead Time</a> <a href="/tags/Leadership/" style="font-size: 11.25px;">Leadership</a> <a href="/tags/Loop/" style="font-size: 11.25px;">Loop</a> <a href="/tags/Management/" style="font-size: 17.5px;">Management</a> <a href="/tags/Maven/" style="font-size: 11.25px;">Maven</a> <a href="/tags/Milestone/" style="font-size: 10px;">Milestone</a> <a href="/tags/Mocha/" style="font-size: 10px;">Mocha</a> <a href="/tags/Mock/" style="font-size: 12.5px;">Mock</a> <a href="/tags/Modularization/" style="font-size: 10px;">Modularization</a> <a href="/tags/MongoDB/" style="font-size: 10px;">MongoDB</a> <a href="/tags/Mood/" style="font-size: 13.75px;">Mood</a> <a href="/tags/Network/" style="font-size: 10px;">Network</a> <a href="/tags/NodeJS/" style="font-size: 16.25px;">NodeJS</a> <a href="/tags/Opportunity/" style="font-size: 10px;">Opportunity</a> <a href="/tags/POI/" style="font-size: 10px;">POI</a> <a href="/tags/Performance/" style="font-size: 10px;">Performance</a> <a href="/tags/Permanent/" style="font-size: 10px;">Permanent</a> <a href="/tags/Pomodoro/" style="font-size: 10px;">Pomodoro</a> <a href="/tags/Process/" style="font-size: 10px;">Process</a> <a href="/tags/Productivity/" style="font-size: 11.25px;">Productivity</a> <a href="/tags/Programming/" style="font-size: 15px;">Programming</a> <a href="/tags/Promise/" style="font-size: 12.5px;">Promise</a> <a href="/tags/Prototype/" style="font-size: 10px;">Prototype</a> <a href="/tags/Prototype-Chain/" style="font-size: 10px;">Prototype Chain</a> <a href="/tags/Recursion/" style="font-size: 10px;">Recursion</a> <a href="/tags/Retrospect/" style="font-size: 18.75px;">Retrospect</a> <a href="/tags/Risk/" style="font-size: 10px;">Risk</a> <a href="/tags/SPA/" style="font-size: 10px;">SPA</a> <a href="/tags/Scrum/" style="font-size: 10px;">Scrum</a> <a href="/tags/Share/" style="font-size: 10px;">Share</a> <a href="/tags/Sinon-js/" style="font-size: 11.25px;">Sinon.js</a> <a href="/tags/Startup/" style="font-size: 12.5px;">Startup</a> <a href="/tags/Statistics/" style="font-size: 10px;">Statistics</a> <a href="/tags/String-interpolation/" style="font-size: 10px;">String interpolation</a> <a href="/tags/Stuff/" style="font-size: 10px;">Stuff</a> <a href="/tags/Tail-Call-Optimization/" style="font-size: 10px;">Tail Call Optimization</a> <a href="/tags/Thunk/" style="font-size: 10px;">Thunk</a> <a href="/tags/Time-Management/" style="font-size: 11.25px;">Time Management</a> <a href="/tags/Trampoline/" style="font-size: 10px;">Trampoline</a> <a href="/tags/Trip/" style="font-size: 12.5px;">Trip</a> <a href="/tags/TypeScript/" style="font-size: 11.25px;">TypeScript</a> <a href="/tags/UED/" style="font-size: 10px;">UED</a> <a href="/tags/UI/" style="font-size: 10px;">UI</a> <a href="/tags/Unit-Test/" style="font-size: 10px;">Unit Test</a> <a href="/tags/UnitTest/" style="font-size: 16.25px;">UnitTest</a> <a href="/tags/Value/" style="font-size: 10px;">Value</a> <a href="/tags/Visualization/" style="font-size: 10px;">Visualization</a> <a href="/tags/Webassemble/" style="font-size: 10px;">Webassemble</a> <a href="/tags/Weblogic/" style="font-size: 10px;">Weblogic</a> <a href="/tags/Webpack/" style="font-size: 10px;">Webpack</a> <a href="/tags/Workout/" style="font-size: 10px;">Workout</a> <a href="/tags/bind/" style="font-size: 10px;">bind</a> <a href="/tags/browserify/" style="font-size: 10px;">browserify</a> <a href="/tags/bundling/" style="font-size: 10px;">bundling</a> <a href="/tags/i18n/" style="font-size: 11.25px;">i18n</a> <a href="/tags/ngClass/" style="font-size: 10px;">ngClass</a> <a href="/tags/ngRepeat/" style="font-size: 10px;">ngRepeat</a> <a href="/tags/this/" style="font-size: 10px;">this</a> <a href="/tags/人生/" style="font-size: 10px;">人生</a>
    </div>
  </div>


</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> On the road to be a good father, husband, son and web developer, specialized in JS <br/>
			Playing around with Node.js, AngularJS.  Powering thinking through visualization.</p>
	</section>
	 
	<div class="social-font clearfix">
		
		<a href="http://weibo.com/kenspirit" target="_blank" title="weibo"></a>
		
		
		<a href="https://twitter.com/kenspirit" target="_blank" title="twitter"></a>
		
		
		<a href="https://github.com/kenspirit" target="_blank" title="github"></a>
		
		
		<a href="https://www.facebook.com/kenspirit" target="_blank" title="facebook"></a>
		
		
        <a href="https://www.linkedin.com/thinkingincrowd" target="_blank" title="linkedin"></a>
        
	</div>
		<p class="copyright">Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/A-limon/pacman" target="_blank" title="Pacman">Pacman</a> © 2016 
		
		<a href="http://www.thinkingincrowd.me" target="_blank" title="鹄思乱想">鹄思乱想</a>
		
		</p>
</div>
</footer>
    
<script>
  var disqus_shortname = 'thinkingincrowd';
  
  var disqus_url = 'http://www.thinkingincrowd.me/2016/05/16/How-to-use-Sinon-js-to-test-Ajax-in-ExtJS/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//go.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>

<script src="/js/jquery-2.1.0.min.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else
    {
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      h  = $('article h2')
      ah = $('article h2'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  if(ah.length==0){
    t.css('display','none');
  }else{
    c.click(function(){
      ta.css('display', 'block').addClass('fadeIn');
    });
    o.click(function(){
      ta.css('display', 'none');
    });
    $(window).scroll(function(){
      ta.css("top",Math.max(140,320-$(this).scrollTop()));
    });
  };
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina');
  var html = [
  '<a href="#" class="overlay" id="qrcode"></a>',
  '<div class="qrcode clearfix"><span>扫描二维码分享到微信朋友圈</span><a class="qrclose" href="#share"></a><strong>Loading...Please wait</strong><img id="qrcode-pic" data-src="http://s.jiathis.com/qrcode.php?url=' + encodedUrl + '"/></div>',
  '<a href="#textlogo" class="article-back-to-top" title="Top"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="QRcode"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="Weibo"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);
  $('.article-share-qrcode').click(function(){
    var imgSrc = $('#qrcode-pic').attr('data-src');
    $('#qrcode-pic').attr('src', imgSrc);
    $('#qrcode-pic').load(function(){
        $('.qrcode strong').text(' ');
    });
  });
});     
</script>





<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-37378953-1', 'www.thinkingincrowd.me');  
ga('send', 'pageview');
</script>


  </body>
</html>
