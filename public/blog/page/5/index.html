
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Thinking in Crowd / 鹄思乱想</title>
  <meta name="author" content="鹄思乱想">

  
  <meta name="description" content="有一种常用的Excel报表打印实现是用客户定义好的Excel Template, 通过POI来写值进去。 这样的好处是基本可以原汁原味的保留Excel的样式和一些宏。 有时，在Excel里会定义有一些Name, 然后用到某一些Cell里做Validation, 也就是模拟下拉选项的效果。 有时候， &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.thinkingincrowd.me/blog/page/5/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Thinking in Crowd / 鹄思乱想" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Thinking in Crowd / 鹄思乱想</a></h1>
  
    <h2>Swan flying in the immense sky</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:www.thinkingincrowd.me" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/about">About</a></li>
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/06/15/excelavoidvaliationlostafterpoi/">如何避免Microsoft Excel在Cell上定义好的Named Validation的下拉选项在POI写值后丢失</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-06-15T13:54:07+08:00" pubdate data-updated="true">Jun 15<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>有一种常用的Excel报表打印实现是用客户定义好的Excel Template, 通过POI来写值进去。</p>

<p>这样的好处是基本可以原汁原味的保留Excel的样式和一些宏。</p>

<p>有时，在Excel里会定义有一些Name, 然后用到某一些Cell里做Validation, 也就是模拟下拉选项的效果。</p>

<p>有时候，Excel Template经过POI写值后，会发现那个用Validation做成的模拟下拉选项不见了，而未写值前的Excel Template里是有的。 情况可能是这样：</p>

<ol>
<li><p> 在做好Excel Template, 保存的瞬间，光标选在的某个有Named List Validation的Cell上。我们要注意，保存Excel Template里，光标必须落在一些空白或不重要的地方。</p></li>
<li><p>如果你做的Named List里动态写值的，那最好先做一些dummy的list, 在需要做Validation的Cell上，定义好这个Named List Validation, 然后再把那些dummy value删去。</p></li>
</ol>


<p>这样都会有影响，Microsoft的东西有够诡异的了吧？ 哈哈</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/03/06/cleaner-code/">Cleaner Code</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-03-06T21:23:04+08:00" pubdate data-updated="true">Mar 6<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Finished reading Robert Martin&#8217;s &#8220;Clean Code&#8221; these days, I suddenly feel more passionate to write code, to write better and more descriptive code.</p>

<p>Before, I do think my coding style is not bad and stick to it every time when I am writing Java, Javascript, SQL, etc.</p>

<p>However, after digesting the essence of &#8220;Clean Code&#8221;, I am forcing myself to write self-descriptive code, without using comment.</p>

<p>The most important points I do remember after reading it are:</p>

<ol>
<li><p>Longer descriptive name, smaller function</p></li>
<li><p>Boy Scout Rule</p></li>
<li><p>Know your algorithm</p></li>
</ol>


<p>Although &#8220;Clean Code&#8221; has shown us many aspects on how to make the code clean, these two rules are easy to remember, fundamental of others.</p>

<p>Now, I feel the passion of writing code as I am writing a diary, an article.  I feel the impulse of cleaning the mess I got before submitting it again.  What is more, in order to make the code cleaner, I have to make my English better.  haha</p>

<p>Just take below function as an example.  You might not easily figure out what it&#8217;s for.</p>

<pre><code>function groupingFieldFormat(value, p, r, rowIndex, i, ds) {
    var cGrid = ds.cGrid;
    var cGridIsReadonly = (cGrid &amp;&amp; cGrid.isReadonly()) ? true : false;

    if (rowIndex === 0) {
        if (cGrid.id === 'shipmentPackDetail'
               &amp;&amp; p.id === 'packCount') {
            Core.FieldFormat.addCellEditableIndicator(
               config, p, cGridIsReadonly);
        }
        return value;
    }
    var lastRecord = ds.getAt(rowIndex - 1);

    if (lastRecord.data['lineNo'] == r.data['lineNo']
            &amp;&amp;  lastRecord.data[p.id] === value) {
        return '';
    }

    if (cGrid.id === 'shipmentPackDetail'
            &amp;&amp; p.id === 'packCount') {
        Core.FieldFormat.addCellEditableIndicator(
            config, p, cGridIsReadonly);
    }
    return value;
}
</code></pre>

<p>Below is the my modified version.  Which version is better is quite obvious although it still has room to improve.</p>

<pre><code>/**
 * Used by Color, Pack Name, Pack Count in two grids
 */
function eliminateRepeatedValueInGroup(value, colMeta, record, rowIndex, colIndex, dataStore) {
    if (isFirstLineInOneGroup(dataStore, record, rowIndex, colMeta.id)) {
        showPackCountEditableIfNeeded(colMeta, dataStore);
        return value;
    }

    // Always show value for the first row in grid
    // even though not the first line in one pack,
    // so that user is easier to check the group value
    return rowIndex === 0 ? value : '';
}

function isFirstLineInOneGroup(dataStore, record, rowIndex, fieldId) {
    var cGrid = dataStore.cGrid;
    if (cGrid.id === 'shipmentPackDetail') {
        return isFirstLineInOnePack(record);
    }

    var lastRecord = dataStore.getAt(rowIndex - 1);
    if (lastRecord
            &amp;&amp; lastRecord.data[fieldId] !== record.data[fieldId]) {
        return true;
    }
    return false;
}

function isFirstLineInOnePack(record) {
    if (record.data['packSeq'] === 1) {
        return true;
    }
    return false;
}

function showPackCountEditableIfNeeded(colMeta, dataStore) {
    var cGrid = dataStore.cGrid;
    if (cGrid.id === 'shipmentPackDetail'
           &amp;&amp; colMeta.id === 'packCount') {
        var cGridIsReadonly =
           (cGrid &amp;&amp; cGrid.isReadonly()) ? true : false;
        Core.FieldFormat.addCellEditableIndicator(
            {}, colMeta, cGridIsReadonly);
    }
}
</code></pre>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/03/06/marching-on/">Marching On</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-03-06T17:38:09+08:00" pubdate data-updated="true">Mar 6<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Suddenly feel that my mind is trying to move a step further.</p>

<p>Although it&#8217;s a bit late, march on.  Yeah.  <sup>_^</sup></p>

<p>Thanks to all those different kinds of RSS feeds, books, about news, human rights, tech, economics, etc.</p>

<p>Thanks to my kindle.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2006/05/18/short-trip-with-mom-and-dad-for-mothers-day/">Short Trip With Mom and Dad for Mother&#8217;s Day</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2006-05-18T23:12:12+08:00" pubdate data-updated="true">May 18<span>th</span>, 2006</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>During this mother&#8217;s day, Winnie &amp; I had a great vacation with my mom and dad.</p>

<p> </p>

<p><strong>1st Destination:</strong></p>

<p>We had a one day Macau tour on May 12th.  This was the first tour for my family.  When I was still in school, we have never go somewhere.  What is more, my dad prefers watching TV than going out.  He can lay on the sofa all day without moving! <img src="http://spaces.msn.com/rte/emoticons/smile_confused.gif" alt="" />  If this trip hasn&#8217;t been planned to go gambling in Casino Lisboa in Macau.  I guess he would probably not coming to ZH.</p>

<p> </p>

<p>Anyway, We arrived at Macau around 11AM.  My mom didn&#8217;t feel very well because of bus-sick and Vomiting serveral times.  (FYI.  It tooks about 3 hours from Huizhou to Zhuhai;  It tooks about 1 hour from where I live to the Customs between Zhuhai and Macau).  We quickly find a place for lunch first so that my mom can have a rest.  After lunch (noodle &amp; pork bread), we went sight-seeing around Avenida de Almeida Ribeiro (亞美打利庇？大馬路), Senado Square (議事亭前地), Rua de S. Paulo(大三巴街), Fortaleza do Monte Monte Fortress(大炮台).</p>

<p> </p>

<p>About 4:30PM, we decided to go to the Casino Lisboa.  I think my dad has already waited such a long time for this moment came.  Before entering the casino, we made a decision that we have to enter the casino through back door in order to win.<img src="http://spaces.msn.com/rte/emoticons/smile_tongue.gif" alt="" />  I have exchanged 4 chips (100MOP each) to play &#8220;big &amp; small&#8221;.  2 chips for my dad, 1 for my mom and 1 for winnie.</p>

<p> </p>

<p>Why none for me?  Because I always believe that I have no this kind of luck for gambling.  You don&#8217;t believe?  Let me tell you this.  For the first round, we all had no idea what to bet and then winnie decided to took the first step for us.  She asked me, &#8220;what do you bet?  Big or small?&#8221;.  I thought for a while and said, &#8220;Big.&#8221;  Then winnie said loudly, &#8220;OK, I bet small&#8221; and put 1 chip at the side for small.  I was stun by her.  &#8220;Ding, ding, ding&#8221;, desk clear and nobody was allowed to change anymore.  &#8220;Small!!&#8221;  Can you feel what my feeling at that time?<img src="http://spaces.msn.com/rte/emoticons/smile_confused.gif" alt="" />  To be angry, or to be happy?  haha, both.</p>

<p> </p>

<p>After that, my mom and dad became active and discussed with winnie about what should bet next.  Another unbelievable thing is when I asked my dad to take a shot and try, but he said no, it&#8217;s better to let your mom gamble, she&#8217;s more lucky than me.  Can you believe it?  I can&#8217;t!  The one who want to gamble most doesn&#8217;t gamble after he&#8217;s there.<img src="http://spaces.msn.com/rte/emoticons/smile_tongue.gif" alt="" /></p>

<p> </p>

<p>At the end, we counted the chips and found that winnie won 350MOP, my mom won 100MOP, and my dad won 200MOP.  Haha, we won a free trip to Macau.</p>

<p> </p>

<p><strong>2nd Destination:</strong></p>

<p>After a busy day in Macau, we felt very tired and slept until 9AM on the next morning.  The next day&#8217;s destination is the imperial-hotspring in order to take a rest.   But it&#8217;s about 2 hours car from my dorm.  It would more than 3 hours if we take the bus.</p>

<p> </p>

<p>We decided to go to Wanzi to have a seafood lunch and shop for dried seafood first.  You have to respect my mom&#8217;s bargain ability.  We only use 350RMB to buy several bags of those stuffs.  Besides, I still have to thank Cindy to introduce her familiar supplier to me so that we can get lower price.</p>

<p> </p>

<p>After buying the dried seafood, we bought the fresh seafood for our lunch.  This time, the seafood is not as cheap as before, maybe near the Fishing moratorium duration.  But we tried something new, the Sea urchins.  You can take a look at the picture of its shell after I have done with it.<img src="http://spaces.msn.com/rte/emoticons/smile_tongue.gif" alt="" /></p>

<p> </p>

<p>We arrived the hotspring after lunch.  Nothing special.  Just one word:&#8221;Relax&#8221;.</p>

<p> </p>

<p>Ending:</p>

<p>I lost about 2000RMB during this trip.  But for 4 people, it&#8217;s not expensive indeed.  What is more, it&#8217;s quite worthy because I can have such a great time with my parent.  I will make more money and go to other places with them!!  Yeah!.</p>

<p> </p>

<p>After words - A strange phenomenon: my mom didn&#8217;t feel bus-sick and vomit anymore after winning in Casino.  haha<img src="http://spaces.msn.com/rte/emoticons/smile_teeth.gif" alt="" /></p>

<p> </p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2006/05/18/classic-statement-from-winnie-keep-updating/">小茹语录(Keep Updating)</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2006-05-18T19:18:28+08:00" pubdate data-updated="true">May 18<span>th</span>, 2006</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><strong>以下是小茹经典的语录。都不明她的语言点解可以甘搞笑。<img src="http://spaces.msn.com/rte/emoticons/smile_teeth.gif" alt="" /></strong></p>

<p> </p>

<p><em>回气荡肠</em></p>

<p>  －意思：荡气回肠</p>

<p>  －情景：一晚，茹因吃得太饱，肚子发出“咕”一声。然后她就笑笑口甘爆出呢个词。</p>

<p> </p>

<p><em>双按</em></p>

<p>  －意思：双击、double click</p>

<p>  －情景：一晚准备放工，她要关UltraEdit的一个Tag，发现关不了，就话：“点解双按关唔到嘎？”。</p>

<p> </p>

<p><em>人地有压力嘎</em></p>

<p>  －情景：一晚，茹搽完药膏，大叫：“个盖呢？”。我就话：“是不是不在厅啊？”。茹答：“是啊。”后来她回到房，发现原来个盖系房。我就笑啦，点知她就爆出呢句。因为刚看完“巴士阿叔”，所以狂笑。</p>

<p> </p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/6/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/4/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/01/01/why-i-start-blogging-and-in-english/">为什么开始写技术博客, 并且还是用英语?</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/12/25/ued-in-my-pet-project-take-time-part-1/">UED in my pet project - Take Time (Part 1)</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/12/24/my-practices-on-time-management/">My practices on Time Management</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/12/05/a-response-pends-forever-issue-in-mongodb-connect-and-nodejs/">A response pends forever issue in MongoDB, Connect and Node.js</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/10/27/db-design-for-multi-dimension-data/">一个多维度数据匹配的RDBMS数据库表设计的想法</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/08/30/extjs-jasmine-unit-test-part-2-ajax-behavior-2/">ExtJS, Jasmine, Unit Test – Part 2 (Ajax & Behavior)</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/08/13/extjs-jasmine-unit-test-part-1-philosophy-and-test-for-store/">ExtJS, Jasmine, Unit Test - Part 1 (Philosophy and Test for Store)</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/08/06/extjs-jasmine-maven-integration/">ExtJS, Jasmine, Maven - Integration</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/08/05/extjs-jasmine-maven-why-i-am-working-on-them/">ExtJS, Jasmine, Maven - Why I am working on them?</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/07/21/i18n-extjs-and-jawr/">i18n, ExtJS and JAWR</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>Categories</h1>
    <ul id="category-list"><li><a href='/blog/categories/life'>Life (6)</a></li><li><a href='/blog/categories/sword'>Sword (12)</a></li><li><a href='/blog/categories/think'>Think (18)</a></li></ul>
</section>
<section>
  <h1>Tag Cloud</h1>
  <ul class="tag-cloud">
    <li><a style="font-size: 93%" href="//coding/">Coding</a></li>
<li><a style="font-size: 60%" href="//connect/">Connect</a></li>
<li><a style="font-size: 60%" href="//db/">DB</a></li>
<li><a style="font-size: 93%" href="//design/">Design</a></li>
<li><a style="font-size: 60%" href="//excel/">Excel</a></li>
<li><a style="font-size: 137%" href="//extjs/">ExtJs</a></li>
<li><a style="font-size: 93%" href="//gtd/">GTD</a></li>
<li><a style="font-size: 60%" href="//health/">Health</a></li>
<li><a style="font-size: 60%" href="//jawr/">JAWR</a></li>
<li><a style="font-size: 126%" href="//jasmine/">Jasmine</a></li>
<li><a style="font-size: 153%" href="//javascript/">Javascript</a></li>
<li><a style="font-size: 126%" href="//management/">Management</a></li>
<li><a style="font-size: 93%" href="//maven/">Maven</a></li>
<li><a style="font-size: 60%" href="//mongodb/">MongoDB</a></li>
<li><a style="font-size: 126%" href="//mood/">Mood</a></li>
<li><a style="font-size: 60%" href="//node-js/">Node.js</a></li>
<li><a style="font-size: 60%" href="//nodejs/">NodeJS</a></li>
<li><a style="font-size: 60%" href="//poi/">POI</a></li>
<li><a style="font-size: 60%" href="//performance/">Performance</a></li>
<li><a style="font-size: 60%" href="//pomodoro/">Pomodoro</a></li>
<li><a style="font-size: 93%" href="//productivity/">Productivity</a></li>
<li><a style="font-size: 165%" href="//retrospect/">Retrospect</a></li>
<li><a style="font-size: 60%" href="//stuff/">Stuff</a></li>
<li><a style="font-size: 93%" href="//time-management/">Time Management</a></li>
<li><a style="font-size: 112%" href="//trip/">Trip</a></li>
<li><a style="font-size: 60%" href="//ued/">UED</a></li>
<li><a style="font-size: 60%" href="//ui/">UI</a></li>
<li><a style="font-size: 126%" href="//unittest/">UnitTest</a></li>
<li><a style="font-size: 60%" href="//weblogic/">Weblogic</a></li>
<li><a style="font-size: 60%" href="//i18n/">i18n</a></li>

  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/kenspirit">@kenspirit</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'kenspirit',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>

<section>
    <h1>Weibo</h1>
    <iframe id="sina_widget_1730265332" style="width:100%; height:500px;" frameborder="0" scrolling="no" src="http://v.t.sina.com.cn/widget/widget_blog.php?uid=1730265332&height=500&skin=wd_01&showpic=1"></iframe>
</section>



<section class="googleplus googleplus-hidden">
  <h1>
    <a href="https://plus.google.com/chengusky@gmail.com?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - 鹄思乱想 -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'thinkingincrowd';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
