
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Thinking in Crowd / 鹄思乱想</title>
  <meta name="author" content="鹄思乱想">

  
  <meta name="description" content="最近看了李开复作序的书：至关重要的关系，也就是THE START-UP OF YOU的译本。书的英文原名和它的意图其实想说明的是，每个人其实都是和企业家一样，具备相同的特质。 广义的企业家精神：自主独立，足智多谋，满怀抱负，灵活变通，并拥有广泛的人脉。企业家精神是一种生活态度，而不是一个商业概念 &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://kenspirit.github.io/blog/page/2/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Thinking in Crowd / 鹄思乱想" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37378953-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Thinking in Crowd / 鹄思乱想</a></h1>
  
    <h2>Swan flying in the immense sky</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:kenspirit.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/about">About</a></li>
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/tags">Tags</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/06/26/startup-review-permanent-beta/">永久测试之心, 寻求真我</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-06-26T06:39:00+08:00" pubdate data-updated="true">Jun 26<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content">
<p>最近看了李开复作序的书：<a href="http://www.amazon.cn/dp/B00COJ3CVY">至关重要的关系</a>，也就是<a href="http://www.amazon.com/dp/B008NXKYNO">THE START-UP OF YOU</a>的译本。书的英文原名和它的意图其实想说明的是，每个人其实都是和企业家一样，具备相同的特质。  </p>

<blockquote>
  <p>广义的企业家精神：自主独立，足智多谋，满怀抱负，灵活变通，并拥有广泛的人脉。企业家精神是一种生活态度，而不是一个商业概念；是伴随一生的观念，而不只是某一代人的想法。</p>
</blockquote>

<p>这本是 <a href="www.linkedin.com">LinkedIn</a> 创始人 Reid Hoffman 和 硅谷企业家 Ben Casnocha 一起写的书。其实书的内容并不只讲述如何建立重要的人际网络关系，还阐明当前变幻无常的职业环境下，怎么样才能保持竞争力。不知道怎么译成中文书名，就变成只突出关系了，可能为了迎合国内对关系的依赖心理吧。  </p>

<blockquote>
  <p>你的竞争优势是由三种各不相同且不断变化的力量相互作用而形成的：你的资产、你的追求/价值观和市场现实，即你的综合能力在竞争市场的供应状况。</p>
</blockquote>

<h2 id="section">真我，追求</h2>
<p>书中一段让我非常有感触：  </p>

<blockquote>
  <p>你的内心不存在能通过自省发现并为你指明正确方向的＂真我＂。是的，你的追求塑造了你所做的事，但是追求本身就受到你的行动和经历的限制。个性不是你找到的，而是自己浮现的。  </p>
</blockquote>

<p>其实我一直想通过自省来寻找到自我，但发觉真的太难了。身边也缺乏很好的 Mentor，所以一直感觉有点迷茫。我到底应该怎么前行呢？直到看完上面那段话后，终于可以释怀了。回想起前段日子看到 <em>@玉伯也叫射雕</em> 说的＂心要粗糙点＂，<em>@周鸿玮</em> 的这篇<a href="http://m.blog.sina.com.cn/s/blog_49f9228d0101c9pr.html?retcode=0">不喜欢的工作，可能通往一个崭新世界</a>，和自己迷茫前走过的路程，也确实是这么走过来的。  </p>

<p>高考时我就是想考计算机专业，没什么理由。毕业时就是想转行从事软件开发，而不是专业的电子方向 (没考上计算机)。还有就是大学时出国留学的想法以至狂学 TOEFL 和 GRE。 至今我也不知道当时为什么这么想，只是有点一根筋的感觉。  </p>

<p>之前的工作生涯，领导让做什么我就做什么，说去哪个项目就到哪去，不挑活，只认真干。当时的＂真我＂就是做 BA 或者 Consultant (以前感觉那种职位比码农高级点，现在发现沟通和需求分析根本就是码农必备技能)，而且公司也是主靠这部分业务，所以个人在公司发展可以说一帆风顺。快速学习和解决问题的能力，抗压能力，良好沟通能力也同时在这样情况下培养出来。  </p>

<h2 id="section-1">永久测试之心</h2>
<blockquote>
  <p>把职业始终保持在测试阶段，可以强迫自己承认自身还有缺陷，还存在发展空间，还需要适应和进步。不过，这种心态也十分乐观，因为这意味着你有能力改善自己，同时也有能力改变周围的世界。</p>
</blockquote>

<p>永久测试其实是对非常流行的观点＂我们必须找到自己心中真正的优势和渴望做的事情，然后坚持不懈的努力下去，终将取得非凡成就＂进行必要的一些补充和修订。  </p>

<p>虽然如上面所说，自我/价值观需要坚定的去追求，但它也不是一成不变的。因为一开始我们的追求可能是空泛的，含糊的，没有具体步骤和验证过的。我们有时可能只是想当然认为自己想做什么，可以做什么，但不知道能不能做或怎么做。所以必须在实践中验证，也就是不断测试调整的一个过程。  </p>

<p>永久测试其实也是应对市场现实而提出的要求。如果你的优势和能力，并没有市场需求的话也是白搭。其实这个观点和 <a href="http://www.amazon.com/dp/0307887898">LEAN STARTUP</a> 里面的 Build-Measure-Learn 这样一个反馈循环正是异曲同工之处。因为我们面对的是迅速变化的市场和趋势，我们必须像打造一个产品一样，不断测试我们身上的技能是否还满足市场的需求。  </p>

<p>之前从一家毕业后一直工作了7年的公司离职，除了公司一些长久问题，个人已经不太抱希望管理层能解决外，也是感觉需要去外面的世界看看，测试一下自己能否适应市场的需求。后来面试发现，在珠海这个地方，需要多面手的地方不多，自己看重的广泛技能，英语，沟通和快速学习能力并没多少人欣赏。招聘方看你那么多年经验，基本就是看你在他们想要的技术方面，能深入多少，因为他们多数要的是专才。  </p>

<p>但这却是我的短板。我并没哪项技术钻研的很深，脚踏的不够坚实。其实我之前也一直缺乏一定自信，总觉得底气不够。所以，我也就正好调整了一下＂真我＂，决心专攻某一样技术，JS。今后嘛，还是保持一颗<strong>钝</strong>和<strong>粗糙</strong>的心，坚持下去并测试以验证之。  </p>

<blockquote>
  <p>在任何情况下，能够检验我们设想的是行动而非计划。只有在实践过程中才能找到自己努力的方向以及方法。</p>
</blockquote>

<h2 id="abz">ABZ计划</h2>
<p>这是作者提出来的一种规划手段。  </p>

<ul>
  <li>A计划：是我们目前从事的事业，一个我们发挥竞争优势的地方。但是在计划执行过程中，我们还是需要时刻根据情况微调，还有试探性寻求B计划。  </li>
  <li>B计划：在执行A计划途中，如果发现目标或实现途径出现比较大的变化，甚至说客观环境发生重大变动等，就要跳到B计划了。但是B计划从哪冒出来的？其实在不断学习和调整方向中得到。它应该是和A计划不同但相关的方向。最好的方式是在执行A计划同时，从兼职开始做起，试探性去尝试一些想法。这个计划不是仔细计划出来的，而是摸索出来的。    </li>
  <li>Z计划：这已经是我们的最差打算了。就是万一失业了，什么都没有了，我们可以怎么做？银行剩下的钱可以支撑多少个月没工作？这段时间是否足够学新技能？  </li>
</ul>

<p>其实作者强调的就是<strong>不断学习，寻找和调整方向，而且确保有救生方案支撑转变</strong>。</p>

<h2 id="section-2">确立身份</h2>
<blockquote>
  <p>我们应该确立一种身份地位，使其不受老板、地域以及行业的影响。</p>
</blockquote>

<p>这也是文章里让我觉得很重要的一句。因为当今，及往后的职业发展环境，是＂横向＂忠于职业，而非＂纵向＂忠于老板。当然这并非说朝三暮四，到处跳槽。因为无论在哪就职，为所在企业全力拼搏，也是提高自我竞争力，打造人脉的关键。而作者想强调的是，因为世界变化太快了，每个企业，每个行业都有可能发生巨大变化和转折点，比如数码相机的到来导致柯达的没落；智能手机的出现，使得 Nokia 被抛离。所以这种独立于老板，甚至是行业的自身技能身份定位，为日后应对市场变化非常重要。  </p>

<p>所以，对于我们从事 IT 的人来说，写个博客，多参于一些开源项目和活动，做些工作外的作品，是很有必要的。  </p>

<p>确保自身技能跟得上变化后，剩下的就是关系问题了。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/06/14/function-definition-this-and-bind-in-javascript/">Function Definition, This and Bind in JavaScript</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-06-14T20:00:00+08:00" pubdate data-updated="true">Jun 14<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content">
<p>I thought I know the Function definition, execution context and the behavior of <em>this</em> in JavaScript.  However, I realized that actually I don’t or the knowlege is still not firmly grounded in my mind when I wrote some code similar to below snippet but have no instinct of the error.  </p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="kd">var</span> <span class="nx">TestObj</span> <span class="o">=</span> <span class="p">{</span>
</span><span class="line">    <span class="nx">a</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class="line">        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">);</span>
</span><span class="line">    <span class="p">},</span>
</span><span class="line">    <span class="nx">b</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class="line">        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">);</span>
</span><span class="line">        <span class="k">this</span><span class="p">.</span><span class="nx">a</span><span class="p">();</span>
</span><span class="line">    <span class="p">}</span>
</span><span class="line"><span class="p">};</span>
</span><span class="line">
</span><span class="line"><span class="nx">TestObj</span><span class="p">.</span><span class="nx">b</span><span class="p">();</span>
</span><span class="line">
</span><span class="line"><span class="kd">var</span> <span class="nx">c</span> <span class="o">=</span> <span class="nx">TestObj</span><span class="p">.</span><span class="nx">b</span><span class="p">;</span>
</span><span class="line"><span class="nx">c</span><span class="p">();</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>The result will be as below, right?  </p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="nx">B</span>
</span><span class="line"><span class="nx">A</span>
</span><span class="line"><span class="nx">B</span>
</span><span class="line"><span class="nx">A</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>You might suspiciously answer No but If your instint doesnot tell you that and why, then you don’t know JavasScript well either like me.  The result actually is:  </p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="nx">B</span>
</span><span class="line"><span class="nx">A</span>
</span><span class="line"><span class="nx">B</span>
</span><span class="line"><span class="nx">TypeError</span><span class="o">:</span> <span class="nb">Object</span> <span class="p">[</span><span class="nx">object</span> <span class="nx">global</span><span class="p">]</span> <span class="nx">has</span> <span class="nx">no</span> <span class="nx">method</span> <span class="s1">&#39;a&#39;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>It is a little bit awkward or counterintuitive at first glance but it’s JavaScript.  It’s the feature and amazing part.  Let’s break it down piece by piece and see why.  </p>

<h2 id="function-definition">Function definition</h2>
<p>The <em>TestObj</em> includes two methods.  The Function definition there actually creates two anonymous functions and then the references to the functions are assigned to the properties <em>a</em> and <em>b</em>.  Those two functions are not owned by <em>TestObj</em> and just referred by the two properties of <em>TestObj</em>.  This is the most important part causes the confusion.  Hence, above code has not much difference than below except now we assign a name <em>B</em> for one of the function:  </p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="kd">function</span> <span class="nx">B</span><span class="p">()</span> <span class="p">{</span>
</span><span class="line">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">);</span>
</span><span class="line">    <span class="k">this</span><span class="p">.</span><span class="nx">a</span><span class="p">();</span>
</span><span class="line"><span class="p">};</span>
</span><span class="line">
</span><span class="line"><span class="kd">var</span> <span class="nx">TestObj</span> <span class="o">=</span> <span class="p">{</span>
</span><span class="line">    <span class="nx">a</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class="line">        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">);</span>
</span><span class="line">    <span class="p">},</span>
</span><span class="line">    <span class="nx">b</span><span class="o">:</span> <span class="nx">B</span>
</span><span class="line"><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<h2 id="this">this</h2>
<p>In <a href="http://www.ecma-international.org/publications/standards/Ecma-262.htm">ECMA-262</a> edition 5.1:<br />
&gt;<strong>10.4.3 Entering Function Code</strong><br />
&gt;The following steps are performed when control enters the execution context for function code contained in
function object F, a caller provided thisArg, and a caller provided argumentsList:  </p>

<blockquote>
  <ol>
    <li>If the function code is strict code, set the ThisBinding to thisArg.  </li>
    <li>Else if thisArg is null or undefined, set the ThisBinding to the global object.  </li>
    <li>Else if Type(thisArg) is not Object, set the ThisBinding to ToObject(thisArg).  </li>
    <li>Else set the ThisBinding to thisArg.<br />
…</li>
  </ol>
</blockquote>

<p><em>this</em> is a special keyword refers to the binding object in the current execution context of the Function.  </p>

<p>Once we invoke the Function through Object method, the <em>this</em> inside the Function body actually has been set to the <em>TestObj</em> instance.  Hence, <em>TestObj.b()</em> logs B and A consecutively because <em>this.a</em> exists as a property of <em>TestObj</em>.  </p>

<p>However, below statements mean differently.  </p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="kd">var</span> <span class="nx">c</span> <span class="o">=</span> <span class="nx">TestObj</span><span class="p">.</span><span class="nx">b</span><span class="p">;</span>
</span><span class="line"><span class="nx">c</span><span class="p">();</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Actually, variable <em>c</em>  is just another reference pointing to Function B.  Hence <em>c()</em> is same as <em>B()</em>.  When directly invoking Function B, the <em>this</em> is bound to global object.  Because there is no <em>a</em> defined in the global object, error occurs.   </p>

<h2 id="how-to-set-a-particular-object-as-this-to-function">How to set a particular object as <em>this</em> to function</h2>
<p>It’s commonly known that <em>call</em> and <em>apply</em> method can be called on the Function object providing a specific object as <em>this</em>, say:  </p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="kd">var</span> <span class="nx">c</span> <span class="o">=</span> <span class="nx">TestObj</span><span class="p">.</span><span class="nx">b</span><span class="p">;</span>
</span><span class="line"><span class="nx">c</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">TestObj</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>The result is desirable.  However, this approach invokes the Function immediately.  This is normally not the case that a Function has to be assigned to a Reference and passed around which is meant to be executed dynamically, like:  </p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="kd">function</span> <span class="nx">dynamic</span><span class="p">(</span><span class="nx">fn</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">  <span class="nx">fn</span><span class="p">();</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="nx">dynamic</span><span class="p">(</span><span class="nx">TestObj</span><span class="p">.</span><span class="nx">b</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>In this case, we should not use <em>fn.call(TestObj)</em> or <em>fn.apply(TestObj)</em> because it’s a generic Function which should have no knowledge on the Function passed in.  Hence, above is not working.  </p>

<p>There is still another lifesaver though.  The <em>bind</em> method of Function.  This method can take the passed in Object like what <em>call</em> or <em>apply</em> does, but it returns a new Function whose <em>this</em> binding is set to the Object passed in.  So, above code can be revised as:  </p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="kd">function</span> <span class="nx">dynamic</span><span class="p">(</span><span class="nx">fn</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">  <span class="nx">fn</span><span class="p">();</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="nx">dynamic</span><span class="p">(</span><span class="nx">TestObj</span><span class="p">.</span><span class="nx">b</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="nx">TestObj</span><span class="p">));</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>It’s fun, isn’t it?</p>

<p>[Edited on 2013/06/17]: Today, I saw another case which maybe confusing too.  </p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="kd">var</span> <span class="nx">length</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
</span><span class="line">
</span><span class="line"><span class="kd">function</span> <span class="nx">logLength</span><span class="p">()</span> <span class="p">{</span>
</span><span class="line">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="kd">var</span> <span class="nx">TestObj</span> <span class="o">=</span> <span class="p">{</span>
</span><span class="line">    <span class="nx">length</span><span class="o">:</span> <span class="mi">2</span><span class="p">,</span>
</span><span class="line">    <span class="nx">b</span><span class="o">:</span> <span class="nx">logLength</span><span class="p">,</span>
</span><span class="line">    <span class="nx">c</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class="line">        <span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">fn</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">            <span class="nx">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">]();</span>
</span><span class="line">        <span class="p">})(</span><span class="nx">logLength</span><span class="p">);</span>
</span><span class="line">    <span class="p">}</span>
</span><span class="line"><span class="p">};</span>
</span><span class="line">
</span><span class="line"><span class="nx">TestObj</span><span class="p">.</span><span class="nx">b</span><span class="p">();</span>
</span><span class="line"><span class="nx">TestObj</span><span class="p">.</span><span class="nx">c</span><span class="p">();</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>What do you think the console should log?  Will it be <em>2</em> and <em>3</em>?  Actually, the result is <em>2</em> and <em>1</em>.  Because the <em>TestObj.c()</em> actually is calling the function <em>logLength</em> on the arguments Object, and then the <em>this.length</em> is referring to its own length, which is <em>1</em>.  </p>

<p>More fun, right?</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/06/08/how-to-verify-json-data-with-angularjs-httpbackend/">How to Verify JSON Data With AngularJS $httpBackend</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-06-08T22:17:00+08:00" pubdate data-updated="true">Jun 8<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content">
<p>When we are writing Unit Test for AngularJS Controller or Service, it’s pretty common to verify the data posted to server using <a href="http://docs.angularjs.org/api/ngMock.$httpBackend">$httpBackend</a> in ngMock module.  </p>

<p>Consider the most common method: <em>expect(method, url, data, headers)</em>, from the doc, we find that the data is expected to be either <em>String</em> or <em>RegExp</em>.  </p>

<blockquote>
  <p><strong>expect(method, url, data, headers)</strong><br />
Creates a new request expectation.</p>
</blockquote>

<blockquote>
  <p>Parameters<br />
* method – {string} – HTTP method.<br />
* url – {string|RegExp} – HTTP url.<br />
* data(optional) – {(string|RegExp)=} – HTTP request body.</p>
</blockquote>

<p>So normally, below simple case is working as expected:  </p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="nx">$httpBackend</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="s1">&#39;POST&#39;</span><span class="p">,</span> <span class="s1">&#39;http://localhost/timeEntry&#39;</span><span class="p">,</span> <span class="s1">&#39;hello&#39;</span><span class="p">).</span><span class="nx">respond</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="s1">&#39;Done&#39;</span><span class="p">);</span>
</span><span class="line"><span class="nx">$resource</span><span class="p">(</span><span class="s1">&#39;http://localhost/timeEntry/&#39;</span><span class="p">).</span><span class="nx">save</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">);</span>
</span><span class="line"><span class="nx">$httpBackend</span><span class="p">.</span><span class="nx">flush</span><span class="p">();</span>
</span><span class="line">
</span><span class="line"><span class="nx">$httpBackend</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="s1">&#39;POST&#39;</span><span class="p">,</span> <span class="s1">&#39;http://localhost/timeEntry&#39;</span><span class="p">,</span> <span class="sr">/te/g</span><span class="p">).</span><span class="nx">respond</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="s1">&#39;Done&#39;</span><span class="p">);</span>
</span><span class="line"><span class="nx">$resource</span><span class="p">(</span><span class="s1">&#39;http://localhost/timeEntry/&#39;</span><span class="p">).</span><span class="nx">save</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">);</span>
</span><span class="line"><span class="nx">$httpBackend</span><span class="p">.</span><span class="nx">flush</span><span class="p">();</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>However, in real application, the data posted to server is normally in JSON format.  How do we verify JSON data then?  Actually, if we look into the source of the <em>angular-mocks.js</em>, it supports JSON data too although it’s not documented.  </p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line">  <span class="k">this</span><span class="p">.</span><span class="nx">matchData</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">    <span class="k">if</span> <span class="p">(</span><span class="nx">angular</span><span class="p">.</span><span class="nx">isUndefined</span><span class="p">(</span><span class="nx">data</span><span class="p">))</span> <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
</span><span class="line">    <span class="k">if</span> <span class="p">(</span><span class="nx">data</span> <span class="o">&amp;&amp;</span> <span class="nx">angular</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">test</span><span class="p">))</span> <span class="k">return</span> <span class="nx">data</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">d</span><span class="p">);</span>
</span><span class="line">    <span class="k">if</span> <span class="p">(</span><span class="nx">data</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">angular</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="nx">data</span><span class="p">))</span> <span class="k">return</span> <span class="nx">angular</span><span class="p">.</span><span class="nx">toJson</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="o">==</span> <span class="nx">d</span><span class="p">;</span>
</span><span class="line">    <span class="k">return</span> <span class="nx">data</span> <span class="o">==</span> <span class="nx">d</span><span class="p">;</span>
</span><span class="line">  <span class="p">};</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>So below sample also works.  </p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="nx">$httpBackend</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="s1">&#39;POST&#39;</span><span class="p">,</span> <span class="s1">&#39;http://localhost/timeEntry&#39;</span><span class="p">,</span> <span class="p">{</span><span class="nx">firstName</span><span class="o">:</span> <span class="s1">&#39;Ken&#39;</span><span class="p">,</span> <span class="nx">lastName</span><span class="o">:</span> <span class="s1">&#39;Chen&#39;</span><span class="p">}).</span><span class="nx">respond</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="s1">&#39;Done&#39;</span><span class="p">);</span>
</span><span class="line"><span class="nx">$resource</span><span class="p">(</span><span class="s1">&#39;http://localhost/timeEntry/&#39;</span><span class="p">).</span><span class="nx">save</span><span class="p">({</span><span class="nx">firstName</span><span class="o">:</span> <span class="s1">&#39;Ken&#39;</span><span class="p">,</span> <span class="nx">lastName</span><span class="o">:</span> <span class="s1">&#39;Chen&#39;</span><span class="p">});</span>
</span><span class="line"><span class="nx">$httpBackend</span><span class="p">.</span><span class="nx">flush</span><span class="p">();</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>As we see, the JSON data validation requires the JSON data posted to be exactly the same as the expect value provided.  How if the JSON data posted is different on each posting, say guid or timestamp field is contained, and we want to verify whether the JSON data is valid based on our special valiation logic?  </p>

<p>Here is the hack to make AngularJS take our special validation logic.  </p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="kd">var</span> <span class="nx">Validator</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class="line">    <span class="k">return</span> <span class="p">{</span>
</span><span class="line">        <span class="nx">hasMinimumFields</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">entry</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">            <span class="k">return</span> <span class="nx">StringUtil</span><span class="p">.</span><span class="nx">isNotBlank</span><span class="p">(</span><span class="nx">entry</span><span class="p">.</span><span class="nx">id</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">StringUtil</span><span class="p">.</span><span class="nx">isNotBlank</span><span class="p">(</span><span class="nx">entry</span><span class="p">.</span><span class="nx">desc</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
</span><span class="line">                <span class="nx">StringUtil</span><span class="p">.</span><span class="nx">isNotBlank</span><span class="p">(</span><span class="nx">entry</span><span class="p">.</span><span class="nx">lastUpdateOn</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">StringUtil</span><span class="p">.</span><span class="nx">isNotBlank</span><span class="p">(</span><span class="nx">entry</span><span class="p">.</span><span class="nx">status</span><span class="p">);</span>
</span><span class="line">        <span class="p">},</span>
</span><span class="line">        <span class="nx">isNewEntry</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">entry</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">hasMinimumFields</span><span class="p">(</span><span class="nx">entry</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">entry</span><span class="p">.</span><span class="nx">status</span> <span class="o">===</span> <span class="s1">&#39;P&#39;</span><span class="p">;</span>
</span><span class="line">        <span class="p">}</span>
</span><span class="line">    <span class="p">};</span>
</span><span class="line"><span class="p">})();</span>
</span><span class="line">
</span><span class="line"><span class="nx">$scope</span><span class="p">.</span><span class="nx">desc</span> <span class="o">=</span> <span class="s1">&#39;Hello there&#39;</span><span class="p">;</span>
</span><span class="line">
</span><span class="line"><span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span class="line">    <span class="nx">test</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">        <span class="kd">var</span> <span class="nx">entry</span> <span class="o">=</span> <span class="nx">angular</span><span class="p">.</span><span class="nx">fromJson</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
</span><span class="line">        <span class="k">return</span> <span class="p">(</span><span class="nx">entry</span><span class="p">.</span><span class="nx">desc</span> <span class="o">===</span> <span class="nx">$scope</span><span class="p">.</span><span class="nx">desc</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">Validator</span><span class="p">.</span><span class="nx">isNewEntry</span><span class="p">(</span><span class="nx">entry</span><span class="p">);</span>
</span><span class="line">    <span class="p">}</span>
</span><span class="line"><span class="p">};</span>
</span><span class="line"><span class="nx">$httpBackend</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="s1">&#39;POST&#39;</span><span class="p">,</span> <span class="s1">&#39;http://localhost/timeEntry&#39;</span><span class="p">,</span> <span class="nx">data</span><span class="p">).</span><span class="nx">respond</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="s1">&#39;Done&#39;</span><span class="p">);</span>
</span><span class="line"><span class="nx">$scope</span><span class="p">.</span><span class="nx">saveEntry</span><span class="p">();</span> <span class="c1">// Let&#39;s assume this method will post the data with model $scope.desc</span>
</span><span class="line"><span class="nx">$httpBackend</span><span class="p">.</span><span class="nx">flush</span><span class="p">();</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>The hacking as you see is to take advantage of the <em>test</em> method which the <em>RegExp</em> has and AngularJS uses for data matching.  But when the data is not posted as expected, the Unit Test fails with below message:  </p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="nx">Chrome</span> <span class="mf">27.0</span> <span class="p">(</span><span class="nx">Linux</span><span class="p">)</span> <span class="nx">Unit</span><span class="o">:</span> <span class="nx">Controllers</span> <span class="nx">Test</span> <span class="nx">EntryCtrl</span> <span class="nx">should</span> <span class="nx">start</span> <span class="nx">entry</span> <span class="k">in</span> <span class="nx">correct</span> <span class="nx">format</span> <span class="k">if</span> <span class="nx">only</span> <span class="nx">entry</span> <span class="nx">desc</span> <span class="nx">is</span> <span class="nx">filled</span><span class="p">.</span> <span class="nx">FAILED</span>
</span><span class="line"><span class="nb">Error</span><span class="o">:</span> <span class="nx">Expected</span> <span class="nx">POST</span> <span class="nx">http</span><span class="o">:</span><span class="c1">//localhost/timeEntry with different data</span>
</span><span class="line"><span class="nx">EXPECTED</span><span class="o">:</span> <span class="p">{}</span>
</span><span class="line"><span class="nx">GOT</span><span class="o">:</span>      <span class="p">{</span><span class="s2">&quot;status&quot;</span><span class="o">:</span><span class="s2">&quot;P&quot;</span><span class="p">,</span><span class="s2">&quot;actualStartOn&quot;</span><span class="o">:</span><span class="s2">&quot;2013/06/08T21:24+0800&quot;</span><span class="p">,</span><span class="s2">&quot;desc&quot;</span><span class="o">:</span><span class="s2">&quot;First Unit Test&quot;</span><span class="p">,</span><span class="s2">&quot;id&quot;</span><span class="o">:</span><span class="s2">&quot;3849ae1a-4b9c-40be-baa0-60eeaf3af430&quot;</span><span class="p">,</span><span class="s2">&quot;lastUpdateOn&quot;</span><span class="o">:</span><span class="s2">&quot;2013/06/08T13:24:44.104+0000&quot;</span><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>This error message is not quite developer friendly and it doesn’t tell you much about why it failed at first glance.  However, if we make the test data contain the JSON value too, the expect message would be more meaningful.  </p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span class="line">    <span class="nx">desc</span><span class="o">:</span> <span class="nx">$scope</span><span class="p">.</span><span class="nx">desc</span><span class="p">,</span>
</span><span class="line">    <span class="nx">status</span><span class="o">:</span> <span class="s1">&#39;P&#39;</span><span class="p">,</span>
</span><span class="line">    <span class="nx">id</span><span class="o">:</span> <span class="s1">&#39;SHOULD NOT BLANK&#39;</span><span class="p">,</span>
</span><span class="line">    <span class="nx">lastUpdateOn</span><span class="o">:</span> <span class="s1">&#39;SHOULD NOT BLANK&#39;</span><span class="p">,</span>
</span><span class="line">    <span class="nx">test</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">        <span class="kd">var</span> <span class="nx">entry</span> <span class="o">=</span> <span class="nx">angular</span><span class="p">.</span><span class="nx">fromJson</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
</span><span class="line">        <span class="k">return</span> <span class="p">(</span><span class="nx">entry</span><span class="p">.</span><span class="nx">desc</span> <span class="o">!==</span> <span class="nx">$scope</span><span class="p">.</span><span class="nx">desc</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">Validator</span><span class="p">.</span><span class="nx">isNewEntry</span><span class="p">(</span><span class="nx">entry</span><span class="p">);</span>
</span><span class="line">    <span class="p">}</span>
</span><span class="line"><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="nx">EXPECTED</span><span class="o">:</span> <span class="p">{</span><span class="s2">&quot;desc&quot;</span><span class="o">:</span><span class="s2">&quot;First Unit Test&quot;</span><span class="p">,</span><span class="s2">&quot;status&quot;</span><span class="o">:</span><span class="s2">&quot;P&quot;</span><span class="p">,</span><span class="s2">&quot;id&quot;</span><span class="o">:</span><span class="s2">&quot;SHOULD NOT BLANK&quot;</span><span class="p">,</span><span class="s2">&quot;lastUpdateOn&quot;</span><span class="o">:</span><span class="s2">&quot;SHOULD NOT BLANK&quot;</span><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p><em>[Edited on Aug 09th 2013]</em>: After AngularJS accepted my <a href="https://github.com/angular/angular.js/pull/2981">pull request</a> to support Function as validation data last week, we don’t need to use duck-typing for the hack.  The validation logic can be simplified as below and we can even override the Function’s <em>toString()</em> method to give more expressive error message in a cleaner way.  </p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">    <span class="kd">var</span> <span class="nx">entry</span> <span class="o">=</span> <span class="nx">angular</span><span class="p">.</span><span class="nx">fromJson</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
</span><span class="line">    <span class="k">return</span> <span class="p">(</span><span class="nx">entry</span><span class="p">.</span><span class="nx">desc</span> <span class="o">!==</span> <span class="nx">$scope</span><span class="p">.</span><span class="nx">desc</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">Validator</span><span class="p">.</span><span class="nx">isNewEntry</span><span class="p">(</span><span class="nx">entry</span><span class="p">);</span>
</span><span class="line"><span class="p">};</span>
</span><span class="line"><span class="nx">data</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class="line">    <span class="k">return</span> <span class="s1">&#39;The status of the new entry should be &quot;P&quot;, desc should be &quot;&#39;</span> <span class="o">+</span> <span class="nx">$scope</span><span class="p">.</span><span class="nx">desc</span> <span class="o">+</span>
</span><span class="line">        <span class="s1">&#39;&quot; and its id &amp; lastUpdateOn should not be blank.&#39;</span><span class="p">;</span>
</span><span class="line"><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="nx">EXPECTED</span><span class="o">:</span> <span class="nx">The</span> <span class="nx">status</span> <span class="nx">of</span> <span class="nx">the</span> <span class="k">new</span> <span class="nx">entry</span> <span class="nx">should</span> <span class="nx">be</span> <span class="s2">&quot;P&quot;</span><span class="p">,</span> <span class="nx">desc</span> <span class="nx">should</span> <span class="nx">be</span> <span class="s2">&quot;First Unit Test&quot;</span> <span class="nx">and</span> <span class="nx">its</span> <span class="nx">id</span> <span class="o">&amp;</span> <span class="nx">lastUpdateOn</span> <span class="nx">should</span> <span class="nx">not</span> <span class="nx">be</span> <span class="nx">blank</span><span class="p">.</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/05/28/how-to-ask-share-and-influence/">一点点对提问，分享和影响力的看法</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-05-28T21:48:00+08:00" pubdate data-updated="true">May 28<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content">
<p>一晚和一位旧同事在 KFC 从10点夜谈到凌晨 3 点。很久没那么年轻过了。我们谈了什么？ 主要是提问，指导和分享，人格魅力和影响力，投资等方面。  </p>

<h2 id="section">提问，指导和分享</h2>
<p>谈这个问题的起源是因为他刚换工作，觉得某些＂领导＂交代任务的时候，啥都不说清楚，什么相关文档资料都不给。所以他很郁闷地在想，到底是他太笨还是本该交待的没说清楚。后来直到他去问时，对方才像挤牙膏那么挤出来那么一点指引，和给他本该先交出的文档。  </p>

<p>到底应该怎么问问题，怎样才算是好的指导和分享呢？  </p>

<h3 id="section-1">什么该交代</h3>
<p>对于交代任务，到底什么应该说清楚？ 从我的自身体验来讲，无论对方是否对所要交代的任务有经验，任务<strong>需求</strong>和项目内<strong>约定俗成</strong>的东西，比如代码规范，公司或项目里特殊的工具环境配置，代码库结构等，是必须交代清楚，至少文档齐备。当然还有一个是任务的<strong>时间要求</strong>，因为这是提供给接收任务方做好时间安排和判断应该什么时候寻求帮助的重要条件。如果这些东西缺失了，就是交代任务的人的责任了。  </p>

<p>我一般的做法，是先把文档给出去，可是不会先详细说明。这是因为不同的人，对资料吸收能力不同，我会期望任务接收者先花时间看了，心中有了问题，再针对情况进一步决定是否需要更进一步解说。这样既有针对性，还可以用以初步判断一个人的自学和领悟能力。  </p>

<h3 id="section-2">什么可以问，怎么问</h3>
<p>对于接收任务的一方来说，如果发现上面提到的应有资料有缺失，我觉得是完全可以而且应该先索取和问清楚，因为你不具备这个责任和条件知道这方面的知识。   </p>

<p>拿到资料后，通常在问问题之前，我觉得都必须<strong>认真看过资料 30 分钟到 1 小时的时间</strong>。时间短了，感觉并不能了解清楚；时间长了，如果对文档所说的还是没什么头绪的话，就不应该再闷头苦猜，而是应该求教于交代任务的人，以避免浪费无谓时间。毕竟工作任务都是有时间限制的。  </p>

<p>在看资料的时候，我觉得需要了解的，是各个文档的大概内容，相互关系和在任务里各自起的作用。完后，就可以向交代任务的人确定任务开始的方向和提出看文档后产生的具体疑问了。问问题，最好是可以<strong>一次把所有问题有条理的列出来，一次去问。而不是碰到一个问题，问一个</strong>。  </p>

<p>正如前面提及，你问的问题，交代任务的人可以用以推断你的能力。需求方面的问题，可以推断出你的逻辑思维能力和对业务的理解。这方面的问题，一开始的时候不懂，是情有可原的，因为毕竟缺乏业务背景。系统设计或技术方面的问题，就可以看出你的经验，技术功底了。对于行业公共技术，应先尽可能 Google 找资料，没办法了，再去问，一方面避免问了些小白问题，另一方面可以提高自己学习能力。对于公司内部特有的技术或框架，我觉得能理解当然最好，时间紧迫的话，求助也无妨。  </p>

<h3 id="section-3">怎样才算是好的指导和分享</h3>
<p>当同事或下属向你请教，或者你发现他们有什么地方做的不够好的时候，及时向他们提供指导和经验分享，才是一位称职的专业人士。但是怎样的指导才叫好呢？那晚，那个同事和我提到他之前遇到的几种指导的风格：  </p>

<ol>
  <li>
    <p>手把手风格<br />
 这种指导方式，是每个新手最喜欢的。因为领导事无巨细，把要完成任务的每一个步骤，都详细解说一遍。最重要的是，讲到你明白为止，而且还是极有耐心，毫无怨言那种。  </p>
  </li>
  <li>
    <p>详尽风格<br />
 这种风格，也会交代出要完成任务的主要步骤，只是没那么详尽，所以也不会向第一种那样毫无怨言的讲到明白为止啦。  </p>
  </li>
  <li>
    <p><strong>启发性风格</strong><br />
 这种风格，只会提示重要的点或者步骤，甚至只发个网上的链接让发问者参考，可能就完事了。还是不懂的话，再针对大流程和框架解说一下。反正基本原则是怎么都不轻易把答案直接告诉你。  </p>
  </li>
</ol>

<p>你们喜欢哪种？你们觉得我是哪种呢？  </p>

<p>那位旧同事说，他现在觉得最后一种，才是最好的。这是因为<strong>授人以鱼不如授人以渔</strong>。如果教会你在某个公司，某个项目里，特定的某些做法，让你可以顺利地完成任务，可能只是一时受益。但是长远来说，如果养成依赖，靠别人指导，而不是自己分析解决问题，其实一点用处都没有。相反，如果能一步步启发思考，尽量让你自己解决问题，以后无论什么环境，都能很好适应。  </p>

<p>其实我的风格是第三种 (别说我自夸啊，不信去问那个家伙) 。但是当初他刚毕业，我带他做项目时，他被我折磨地痛苦的要死。他和另一个人老是在琢磨该不该问我问题。看我脸色不太对劲的话，就不敢问了。回想起来，那时候，他不会我们系统的框架，不懂 Javascript，只想写 JAVA。而我不断逼他自己主要看JS代码，教他怎么猜测代码块的上下文，在不懂全部方法的情况下，猜测 Bug 可能在什么地方，怎么忽略代码细节，领略大意等。也是难为他了。  </p>

<p>其实我相信我做的是对的，可是为什么他那时那么痛苦呢？  </p>

<ol>
  <li>
    <p>语气问题
 有时候我的语气感觉比较凶和严，所以他会认为我不够耐心。其实用第三种风格的话，每次提醒的点是不多的，所以一旦语气不好，别人就会认为你没耐心，不想教。我的情况是，对女的态度好点，对聊得来或关系好的朋友说话会没那么多顾虑，对一些感觉学习态度有问题，或者自己不仔细思考的人我会没耐心。他是第二种。  </p>
  </li>
  <li>
    <p>解释是否通俗易懂<br />
 他说他现在的一个同事，在向他解释一些他不懂的技术概念的时候，讲的很通俗易懂。而我，当时给他的感觉是解释的不够容易理解。除了上面的语气和耐心也有影响外，一个人要把事情解释到通俗易懂，他必须对要解释的事物有深刻了解，然后能从听众的角度，简化概念，尽量转换成比较容易理解的事物类比。这点我确实是做得不够好的。因为以前我的技术功底确实不深厚 (当然现在也还不行)，要能做到深入浅出确实不行。而且我有时没能从听众角度出发，也是造成难理解的原因。  </p>
  </li>
</ol>

<h2 id="section-4">人格魅力与影响力</h2>
<p>那天晚上，我们聊到了电影中国合伙人，俞敏洪，罗永浩，马云等。我那个同事说以前他以为新东方火的原因是上课幽默。其实后来想想应该不是，主要应该是俞敏洪乐于分享，而且难能可贵的是把自己失败的地方和人分享，把自己和听众拉到同一平面上，产生共鸣，另听众感同身受。不像一些只会宣传自己成功经验的人，虽然一时能让听众产生仰慕之情，但感觉高高在上，经验之谈也飘渺不切实际。  </p>

<p>我至今碰到的，和尊敬的有非凡人格魅力的人或公司，都是肯无私分享自己实际经验，技能和想法，让别人觉得能从你身上学到东西的人或公司。一旦你身边围绕着一群向你学习的忠实听众，人格魅力和影响力就出来了。像马云，罗永浩还有现在 IT 领域各种大牛等，凭借他们无私的演讲，博客，对开源贡献等积累的忠实听众，为他们的公司，产品营销，创业起了多大的作用。在 <a href="http://www.amazon.com/Rework-Jason-Fried/dp/0307463745">Rework</a> 里面 <strong>Build an Audience</strong> 那节说的很好：    </p>

<blockquote>
  <p>the most fortunate companies have <em>audiences</em>.<br />
…<br />
When you build an audience, you don’t have to buy people’s attention—they give it to you. This is a 
huge advantage. So build an audience. Speak, write, blog, tweet, make videos, whatever. Share 
information that’s valuable and you’ll slowly but surely build a loyal audience. Then, when you need 
to get the word out, the right people will already be listening.</p>
</blockquote>

<p>在此，我也要向之前无私教导我的人，Google 公司，令我获益的各位大牛和博客致敬，努力成为分享的一员。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/04/25/review-on-book-inside-the-facebook/">打造 Facebook 读后感</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-04-25T06:10:00+08:00" pubdate data-updated="true">Apr 25<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content">
<p>看完<em><a href="http://www.amazon.cn/gp/product/B0060E1LIK/ref=ox_ya_os_product">YouTube 创始人陈士俊自传</a>_后，很快我又把</em><a href="http://www.amazon.cn/dp/B00ANI5YXW">打造 Facebook</a>_看完了。但感觉这没上本书过＂瘾＂，我看得更快和粗略。  </p>

<p>笔者王淮主要是为外部人士揭秘 Facebook  内部一些流程和机制，包括招聘，人员培养，团队合作，项目流程等。本书内容叙述直白，但略显平淡和笼统。揭秘的 Facebook 流程，其实也和其他一些关于敏捷，管理等文章提及的好的做法没太大差别。这其实也在意料之中，因为核心机密也没可能爆料，加上好的做法本来就那些，关键看怎么做，执行力如何和团队配合，而且最主要是配合不同公司文化，架构和流程作调整。  </p>

<p>下面我只抽 Facebook 做得比多数公司好的其它关键说说。  </p>

<h2 id="section">制胜关键</h2>

<h3 id="section-1">重视内部工具，平台搭建</h3>
<p>可能是和 Facebook 的工程师文化驱动文化也有关，Facebook 内部竟然还有专门的团队负责所有工程师要用的工具和平台的搭建，而且最重要的是这个团队还是被放在最高优先级和重要的位置上，而不是说把二流的人放在那。  </p>

<p>这就应该和其他大多数公司很不同。很多公司都是把重心和一流人才放在产品上面，但却不知道这样一个打造工具和平台的团队，其实才是打造公司核心技术，和提高工程师生产率的重要基石。如果一个公司能为项目工程师提供一键搭建环境，和各种提高生产率以及沟通的工具，那这家公司的技术功底和自动化流程做得有多好啊。  </p>

<h3 id="facebook-">所有人以 Facebook 的整体利益为考虑出发点</h3>
<p>这可不是说那么容易的。特别是大公司，各个部门各自为政，以部门利益为出发点，在人员调配，项目进度安排上可以说是协调的噩梦。每每总要等待各个部门的老大的最顶层上司直接命令下来才能成事。想想中间要花费多少功夫。书中虽然没有提及细节，但好几处都提到和体现这个整体利益。无论在人员换组，项目人手调配，进度安排上，感觉他们都能比较好的处理好，这相当不容易。  </p>

<p>作为一个曾经体验过部门之间要人和不放人，被不同 Manager 带过都被打上不同标签和不平等对待的人，真是气不打一处来。当时还是在家小公司啊。还有就是项目组之间如果有依赖，优先级和协调的重要性现在更是深有体会。  </p>

<p>在 Facebook 里，整体利益的另一体现就是 Don’t reinvent the wheel。  笔者提到的就是他们项目里的核心机器学习的组件，当初考虑到是放在自己支付安全组内还是放在 Anti-Spam 那边。因为那边已经有现成的框架，最后平衡考虑还是放在别组，然后协调和推进。可是很多公司，往往因为只顾部门利益，总想自己造些什么出来显露功绩。即使有现成的东西也不用，造成资源浪费。</p>

<h3 id="section-2">发挥工程师创意</h3>
<p>和 Google 的 20% 自由时间差不多，Facebook 也有内部的 Hackathon 来鼓励工程师做各种好玩的事情，甚至可以推迟项目时间。真是难得。</p>

<h2 id="section-3">八卦</h2>
<p>书里也提到了关于 Facebook 请公关公司炮制散布 Google 负面新闻的事情。Mark 在内部向所有员工说明并要求大家要支持 Marketing 部门，因为它们平常都在保护公司的利益。现在即使犯一点错，也应该得到体谅。  </p>

<p>书里也提到 Mark 很在意公司保密的原则，一但有人出错，坚决处理。  </p>

<p>这里隐含的意思就有点意思了。Mark 是一个很看重公司机密的人。他也很注意公司团结，员工应该一致向外。个人感觉这件事情上，Facebook 的 Marketing 应该不会在老板没出声的情况下，自己乱来吧？何况书中也说到 Mark 在关键问题的产品把控上是很严的。所以，小人之心猜测那也是 Mark 本人的意思。</p>

</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/3/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/11/13/jingjs-2013-fun/">京JS 2013 之神打击</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/11/13/callbacks-are-imperative/">回调函数是指令式的；Promise 是函数式的：Node 错失的最大机会</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/09/24/thanks-to-everyone-zach-lendon-github-angularjs/">Thanks to everyone, Zach Lendon, Github, AngularJS</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/08/29/how-to-support-page-content-i18n-in-angularjs/">How to support page content i18n in AngularJS</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/06/29/startup-review-network/">至关重要的关系</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/06/26/startup-review-permanent-beta/">永久测试之心, 寻求真我</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/06/14/function-definition-this-and-bind-in-javascript/">Function definition, this and bind in JavaScript</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/06/08/how-to-verify-json-data-with-angularjs-httpbackend/">How to verify JSON data with AngularJS $httpBackend</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/05/28/how-to-ask-share-and-influence/">一点点对提问，分享和影响力的看法</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/04/25/review-on-book-inside-the-facebook/">打造 Facebook 读后感</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>Categories</h1>
    <ul id="category-list"><li><a href='/blog/categories/life'>Life (6)</a></li><li><a href='/blog/categories/sword'>Sword (20)</a></li><li><a href='/blog/categories/think'>Think (28)</a></li></ul>
</section>
<section>
  <h1>Tag Cloud</h1>
  <ul class="tag-cloud">
    <li><a style="font-size: 60%" href="/tags/amd/">AMD</a></li>
<li><a style="font-size: 60%" href="/tags/adapt/">Adapt</a></li>
<li><a style="font-size: 60%" href="/tags/ajax/">Ajax</a></li>
<li><a style="font-size: 121%" href="/tags/angularjs/">AngularJS</a></li>
<li><a style="font-size: 60%" href="/tags/blogging/">Blogging</a></li>
<li><a style="font-size: 112%" href="/tags/book/">Book</a></li>
<li><a style="font-size: 60%" href="/tags/callback/">Callback</a></li>
<li><a style="font-size: 86%" href="/tags/change/">Change</a></li>
<li><a style="font-size: 102%" href="/tags/coding/">Coding</a></li>
<li><a style="font-size: 60%" href="/tags/connect/">Connect</a></li>
<li><a style="font-size: 60%" href="/tags/db/">DB</a></li>
<li><a style="font-size: 86%" href="/tags/design/">Design</a></li>
<li><a style="font-size: 86%" href="/tags/destiny/">Destiny</a></li>
<li><a style="font-size: 86%" href="/tags/directive/">Directive</a></li>
<li><a style="font-size: 60%" href="/tags/excel/">Excel</a></li>
<li><a style="font-size: 60%" href="/tags/execution-context/">Execution context</a></li>
<li><a style="font-size: 128%" href="/tags/extjs/">ExtJs</a></li>
<li><a style="font-size: 60%" href="/tags/function-definition/">Function definition</a></li>
<li><a style="font-size: 86%" href="/tags/gtd/">GTD</a></li>
<li><a style="font-size: 86%" href="/tags/goal/">Goal</a></li>
<li><a style="font-size: 60%" href="/tags/health/">Health</a></li>
<li><a style="font-size: 86%" href="/tags/httpbackend/">HttpBackend</a></li>
<li><a style="font-size: 60%" href="/tags/influence/">Influence</a></li>
<li><a style="font-size: 60%" href="/tags/jawr/">JAWR</a></li>
<li><a style="font-size: 60%" href="/tags/jsconf/">JSConf</a></li>
<li><a style="font-size: 86%" href="/tags/json/">JSON</a></li>
<li><a style="font-size: 128%" href="/tags/jasmine/">Jasmine</a></li>
<li><a style="font-size: 165%" href="/tags/javascript/">Javascript</a></li>
<li><a style="font-size: 60%" href="/tags/jingjs/">JingJS</a></li>
<li><a style="font-size: 128%" href="/tags/management/">Management</a></li>
<li><a style="font-size: 86%" href="/tags/maven/">Maven</a></li>
<li><a style="font-size: 102%" href="/tags/mock/">Mock</a></li>
<li><a style="font-size: 60%" href="/tags/modularization/">Modularization</a></li>
<li><a style="font-size: 60%" href="/tags/mongodb/">MongoDB</a></li>
<li><a style="font-size: 112%" href="/tags/mood/">Mood</a></li>
<li><a style="font-size: 60%" href="/tags/network/">Network</a></li>
<li><a style="font-size: 112%" href="/tags/nodejs/">NodeJS</a></li>
<li><a style="font-size: 60%" href="/tags/opportunity/">Opportunity</a></li>
<li><a style="font-size: 60%" href="/tags/poi/">POI</a></li>
<li><a style="font-size: 60%" href="/tags/performance/">Performance</a></li>
<li><a style="font-size: 60%" href="/tags/permanent/">Permanent</a></li>
<li><a style="font-size: 60%" href="/tags/pomodoro/">Pomodoro</a></li>
<li><a style="font-size: 86%" href="/tags/productivity/">Productivity</a></li>
<li><a style="font-size: 60%" href="/tags/promise/">Promise</a></li>
<li><a style="font-size: 157%" href="/tags/retrospect/">Retrospect</a></li>
<li><a style="font-size: 60%" href="/tags/risk/">Risk</a></li>
<li><a style="font-size: 60%" href="/tags/spa/">SPA</a></li>
<li><a style="font-size: 60%" href="/tags/share/">Share</a></li>
<li><a style="font-size: 102%" href="/tags/startup/">Startup</a></li>
<li><a style="font-size: 60%" href="/tags/string-interpolation/">String interpolation</a></li>
<li><a style="font-size: 60%" href="/tags/stuff/">Stuff</a></li>
<li><a style="font-size: 86%" href="/tags/time-management/">Time Management</a></li>
<li><a style="font-size: 102%" href="/tags/trip/">Trip</a></li>
<li><a style="font-size: 60%" href="/tags/ued/">UED</a></li>
<li><a style="font-size: 60%" href="/tags/ui/">UI</a></li>
<li><a style="font-size: 128%" href="/tags/unittest/">UnitTest</a></li>
<li><a style="font-size: 60%" href="/tags/webassemble/">Webassemble</a></li>
<li><a style="font-size: 60%" href="/tags/weblogic/">Weblogic</a></li>
<li><a style="font-size: 60%" href="/tags/bind/">bind</a></li>
<li><a style="font-size: 86%" href="/tags/i18n/">i18n</a></li>
<li><a style="font-size: 60%" href="/tags/ngclass/">ngClass</a></li>
<li><a style="font-size: 60%" href="/tags/ngrepeat/">ngRepeat</a></li>
<li><a style="font-size: 60%" href="/tags/this/">this</a></li>

  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/kenspirit">@kenspirit</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'kenspirit',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>

<section>
    <h1>Weibo</h1>
    <iframe id="sina_widget_1730265332" style="width:100%; height:500px;" frameborder="0" scrolling="no" src="http://v.t.sina.com.cn/widget/widget_blog.php?uid=1730265332&height=500&skin=wd_01&showpic=1"></iframe>
</section>



<section class="googleplus googleplus-hidden">
  <h1>
    <a href="https://plus.google.com/chengusky@gmail.com?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - 鹄思乱想 -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'thinkingincrowd';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>











</body>
</html>
